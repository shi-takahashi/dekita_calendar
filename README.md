# 🗓 できたカレンダー

## 📌 アプリ概要
「できたカレンダー」は、習慣の達成を記録し、継続状況をカレンダーで可視化する Flutter 製アプリです。  
アカウント不要・ローカル保存でシンプルに使えます。広告モデルで運営予定。  

---

## 🎯 基本コンセプト
- 習慣管理 × 可視化アプリ  
- シンプルに「続ける」をサポート  
- 直感的な UI、達成感を重視  

---

## 🗂 データモデル（概要）
- **習慣（Habit）**
  - タイトル  
  - 頻度（毎日 / 週X回 / 特定曜日）  
  - 通知時間（任意）  
  - 達成履歴（日付のリスト）  
  - 作成日・更新日  

---

## 📱 画面構成と機能

### ホーム画面
- 今日の習慣リスト（チェックボックスで達成管理）  
- 連続達成日数（ストリーク）表示  
- 新規習慣登録  

### カレンダー画面
- 月単位で達成状況を色マークで表示  
- 日付タップで達成履歴確認  

### 統計画面
- 習慣ごとの達成率グラフ（週／月単位）  
- 最大ストリーク表示  

### 設定画面
- 習慣の管理（編集・削除）
- 習慣ごとの通知設定（時刻・曜日指定）
- ライト／ダークテーマ切替
- 広告情報表示  

---

## ⚙️ 主な機能一覧
- 習慣の登録・編集・削除
- 達成チェック／取り消し
- カレンダー連動で達成状況を可視化
- 統計グラフで達成率を確認
- 連続日数（ストリーク）表示
- PUSH通知リマインダー（毎日・特定曜日対応、自動繰り返し）
- テーマ切替（ライト／ダーク）
- バナー広告表示  

---

## 🚀 開発ステップ（MVP）
1. ✅ UI設計・データモデル設計
2. ✅ 習慣登録・管理機能
3. ✅ チェックイン・カレンダー連動
4. 🚧 統計画面（達成率グラフ）
5. ✅ 通知機能
6. 🚧 テーマ切替
7. 🔜 広告導入・ストア準備  

---

## 📝 開発進捗

### ✅ 完了済み（2025-09-30）
1. **プロジェクト初期設定**
   - Flutterプロジェクト作成（パッケージ名: io.github.shitakahashi.dekitacalendar）
   - プロジェクト構造の設定（models, views, controllers, services, widgets, utils）

2. **データモデル定義**
   - Habitクラスの実装
   - 頻度設定（毎日/週X回/特定曜日）
   - 達成履歴管理
   - ストリーク計算機能

3. **基本画面構成**
   - BottomNavigationBarの実装
   - 4つの画面（ホーム、カレンダー、統計、設定）の基本レイアウト作成

### ✅ 完了済み（2025-10-01）
4. **習慣管理機能**
   - HabitRepository実装（SharedPreferencesを使用したローカルストレージ）
   - HabitController実装（習慣のCRUD操作管理）
   - 習慣登録画面（AddHabitScreen）の実装
   - 習慣編集画面（EditHabitScreen）の実装
   - 習慣削除機能（確認ダイアログ付き）

5. **ホーム画面機能**
   - 今日の習慣リスト表示
   - 習慣の完了/未完了チェック機能
   - ストリーク（連続達成日数）表示
   - 頻度別フィルタリング（毎日/週X回/特定曜日）
   - プルダウンで更新機能

### ✅ 完了済み（2025-10-06）
6. **カレンダー画面**
   - table_calendarパッケージを使用した月表示カレンダー
   - 習慣の達成状況を色分けマーカーで表示（緑：100%、オレンジ：50%以上、黄：一部達成、赤：未達成）
   - 日付タップで習慣詳細と完了/未完了の切り替え
   - 過去の日付のみ完了状態を変更可能

7. **週X回機能の改善**
   - 月曜始まりの週管理
   - リアルタイム進捗表示「今週あと○回 (完了数/目標数)」
   - 目標達成時の明確なフィードバック

8. **UX改善**
   - 「本日完了」バッジで完了状態を明確化
   - 次回実行日に応じたメッセージ表示
   - 取り消し線を廃止し、より直感的なUI

### ✅ 完了済み（2025-10-08）
9. **PUSH通知機能**
   - Androidネイティブ（AlarmManager + BroadcastReceiver）を使用した確実な通知配信
   - 毎日・特定曜日の通知スケジューリング
   - 通知後の自動再設定（毎日繰り返し/毎週繰り返し）
   - 習慣削除時の通知自動キャンセル
   - 習慣編集時の通知自動更新（曜日変更・時刻変更に対応）
   - 正確な時刻での通知配信（setExactAndAllowWhileIdle使用）

### ✅ 完了済み（2025-10-08）
10. **広告機能の実装**
   - バナー広告（画面下部、事前ロード対応）
   - インタースティシャル広告（過去日付の習慣完了時に表示）
   - デバッグ/リリースビルドで異なる広告ID管理
   - 確認ダイアログ付きのUX実装

### ✅ 完了済み（2025-10-10）
11. **バッジシステムの実装**
   - 5段階のバッジ（ブロンズ、シルバー、ゴールド、プラチナ、ダイヤモンド）
   - 連続達成日数に応じたバッジ獲得（3日、7日、30日、100日、365日）
   - 流れ星アニメーション演出（左上から右下へ斜めに流れる）
   - バッジ獲得ダイアログ（回転＆拡大表示）
   - バッジコレクション表示（明るい背景で視認性向上）
   - 一度獲得したバッジは永続保存
   - デバッグモード（連続日数の手動設定、バッジテスト機能）

### 🚧 次の実装予定

#### バッジシステムの週単位化（最優先）
**背景**：現在の日数ベースでは、週1回の習慣で最高ランク到達に7年かかり不公平

- **週単位の評価システムへ移行**
  - その週（月曜〜日曜）の予定を全て完了で1週クリア
  - バッジ条件：1週、2週、4週、12週、52週連続
  - 毎日の習慣でも週1の習慣でも公平に評価
  - UI表示を「○日」→「○週」に変更

詳細は `docs/badge_weekly_system.md` を参照

#### 統計画面の強化
- 達成率グラフ（週/月単位）
- 最大ストリーク表示
- 習慣ごとの詳細統計

#### その他のUX改善
- カラフルなテーマカラー設定
- 完了時のマイクロインタラクション
- 達成感を高めるサウンドエフェクト（オプション）

---

## 💡 将来的な機能計画

### 🎯 過去日付の完了機能（広告連動）
- **目的**：ユーザーのモチベーション維持と収益化の両立
- **仕組み**：
  - 通常は過去の日付は変更不可
  - インタースティシャル広告視聴により過去の完了を許可
  - 途切れたストリーク（連続記録）を修復可能に
- **メリット**：
  - ユーザー：モチベーション維持、柔軟な記録管理
  - 開発者：広告収益の確保
  - Win-Winの関係構築

### 📊 その他の検討機能
- **週N回設定**：「週3回」のような柔軟な頻度設定（複雑な月跨ぎ計算が必要なため将来検討）
- プレミアムプラン（広告非表示、無制限の過去編集など）
- クラウドバックアップ
- ウィジェット対応
- Apple Watch / Wear OS対応

---
